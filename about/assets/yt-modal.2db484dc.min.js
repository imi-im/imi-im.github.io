import{t as u}from"./assets/chunks/breakpoints.9c3b8d32.min.js";function m(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)||f()}function y(){return/Android/i.test(navigator.userAgent)}function f(){return navigator.userAgent.toLowerCase().indexOf("macintosh")!==-1&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>2}var b=class{constructor(){this.loadedScripts={},this.disposed=!1}load(t,e){const i=this.loadedScripts[t];if(i)return i;const a=new Promise((o,n)=>{if(e.test()){o();return}this.renderScriptTag(t,e);const l=Date.now(),h=e.timeout||5e3,d=()=>{if(this.disposed){n("script loader is disposed");return}if(e.test()){o();return}if(Date.now()-l>h){n(`failed to load ${t} due to timeout`);return}window.requestAnimationFrame(d)};window.requestAnimationFrame(d)});return this.loadedScripts[t]=a,a.catch(o=>{console.error(`failed to load ${t}`),console.error(o),delete this.loadedScripts[t]}),a}renderScriptTag(t,e){const i=document.createElement("script");if(e?.attrs)for(const a in e.attrs){const o=e.attrs[a];i.setAttribute(a,o)}i.src=t,document.body.appendChild(i)}renderDom(t){this.renderScriptTag(t)}dispose(){this.loadedScripts={},this.disposed=!0}},g="https://www.youtube.com/iframe_api?trustedtypes=1",v={namespace:"degu-youtube-modal",useHandlerOnMobile:!0,transitionDuration:300,parentSelector:"body",playerVars:{autohide:1,autoplay:1,fs:1,modestbranding:1,rel:0,showinfo:0,iv_load_policy:3},scriptLoader:new b},s={ENTER:"Enter",ESC:"Escape",SPACE:" "},E=class{constructor(t){this.isVisible=!1,this.config=Object.assign({},v,t),this.container=document.querySelector(this.config.parentSelector);const e=this.createDom("div",this.config.namespace);e.setAttribute("aria-modal","true"),e.setAttribute("role","dialog");const i=this.createDom("button",`${this.config.namespace}__x`);i.setAttribute("aria-label","Close video player"),i.setAttribute("tabindex","0"),i.addEventListener("click",()=>{this.setActive(!1)}),this.closeEl=i;const a=this.createDom("div",`${this.config.namespace}__attribution`);this.attributionEl=a;const o=this.createDom("div",`${this.config.namespace}__player`);this.playerEl=o;const n=this.createDom("div",`${this.config.namespace}__mask`);e.appendChild(i),e.appendChild(a),e.appendChild(o),e.appendChild(n),this.modalEl=e,this.container.appendChild(e),document.addEventListener("click",this.handleEvent.bind(this)),document.addEventListener("keydown",this.handleKeyboardEvent.bind(this))}async play(t,e){const i=e||{};if(this.config.useHandlerOnMobile&&(m()||y())){let o=`https://m.youtube.com/watch?v=${t}`;i.startTime&&(o=`${o}&t=${i.startTime}s`),window.location.href=o;return}await this.config.scriptLoader.load(g,{test:()=>window.YT&&window.YT.loaded===1}),i.attribution&&(this.attributionEl.textContent=i.attribution);const a=i.orientation||"landscape";if(this.modalEl.setAttribute("data-orientation",a),this.setActive(!0),this.player){if(t===this.activeVideoId)return;this.player.loadVideoById(t,i.startTime||0,"large"),this.activeVideoId=t}else{const o=Object.assign({},this.config.playerVars);i.startTime&&(o.start=i.startTime),o.origin=location.protocol+"//"+location.host;const n={videoId:t,playerVars:o,events:{onReady:l=>{l.target.playVideo()}}};this.player=new YT.Player(this.playerEl,n)}}getPlayOptionsFromAttrs(t){const e={},i=+(t.getAttribute(`data-${this.config.namespace}-video-start-seconds`)||0);i>0&&(e.startTime=i);const a=t.getAttribute(`data-${this.config.namespace}-attribution`);a&&(e.attribution=a);const o=t.getAttribute(`data-${this.config.namespace}-orientation`);return o&&(e.orientation=o),e}setActive(t){t?(this.lastScrollY=window.pageYOffset,this.lastFocusedEl=document.activeElement,window.setTimeout(()=>{this.closeEl.focus(),this.config.onModalOpen&&this.config.onModalOpen(this)},this.config.transitionDuration+100)):window.setTimeout(()=>{this.lastFocusedEl&&(this.lastFocusedEl.focus(),this.lastFocusedEl=void 0),window.scrollTo({left:0,top:this.lastScrollY}),this.config.onModalClose&&this.config.onModalClose(this)},this.config.transitionDuration+100),this.setVisible(t)}getPlayer(){return this.player}dispose(){document.removeEventListener("click",this.handleEvent.bind(this)),document.removeEventListener("keydown",this.handleKeyboardEvent.bind(this)),this.modalEl&&this.container.removeChild(this.modalEl)}createDom(t,e,...i){const a=document.createElement(t);return a.className=e,i&&i.length&&i.forEach(o=>a.appendChild(o)),a}handleEvent(t){let e=t.target;for(;e;){const i=`data-${this.config.namespace}-video-id`,a=e.getAttribute(i);if(a){t.preventDefault();const o=this.getPlayOptionsFromAttrs(e);this.play(a,o);return}e=e.parentElement}}handleKeyboardEvent(t){if(this.isVisible){if(!this.player)return;t.key===s.ESC?this.setActive(!1):t.key===s.SPACE&&(this.player.getPlayerState()===YT.PlayerState.PLAYING?this.player.pauseVideo():this.player.playVideo())}else(t.key===s.ENTER||t.key===s.SPACE)&&this.handleEvent(t)}setVisible(t){window.setTimeout(()=>{this.player&&(t?this.player.getPlayerState()!==YT.PlayerState.PLAYING&&this.player.playVideo():this.player.pauseVideo())},100),window.setTimeout(()=>{this.modalEl.classList.toggle(`${this.config.namespace}--enabled`,t)},t?0:this.config.transitionDuration),window.setTimeout(()=>{this.modalEl.classList.toggle(`${this.config.namespace}--visible`,t),this.isVisible=t},t?this.config.transitionDuration:0)}};const w=`.yt-modal{position:absolute;top:0;left:0;width:100%;height:100%;display:none;opacity:0;position:fixed;transform:scale(1.15);transition:.3s all cubic-bezier(.83,0,.17,1);visibility:hidden;z-index:2000;--yt-player-height:calc(100vh - 7.39707vw);--yt-player-max-height: calc( (100vw - 22.19121vw) * 1 / var(--cmp-yt-modal-aspect-ratio, var(--sys-yt-modal-aspect-ratio)) );--sys-yt-modal-aspect-ratio: 1.7777777778}.yt-modal--enabled{display:block}.yt-modal--visible{opacity:1;transform:scale(1);visibility:visible}.yt-modal[data-orientation=portrait]{--sys-yt-modal-aspect-ratio: .5625}.yt-modal__x{position:absolute;top:0;right:0;width:64px;height:64px;background:black;border:none;cursor:pointer;text-align:center;transition:.3s all;z-index:2003}@media (min-width: 1024px){.yt-modal__x{position:absolute;top:48px;right:48px}}.yt-modal__x:before,.yt-modal__x:after{content:"";display:block;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:3px;height:32px;background:white}.yt-modal__x:before{transform:translate(-50%,-50%) rotate(45deg)}.yt-modal__x:after{transform:translate(-50%,-50%) rotate(-45deg)}.yt-modal__x:focus{outline:none}.yt-modal__mask{position:absolute;top:0;left:0;width:100%;height:100%;background:black;z-index:2001}.yt-modal__player{border-radius:10px;height:var(--yt-player-height);left:50%;max-height:var(--yt-player-max-height);max-width:calc((100vh - 7.39707vw) * var(--cmp-yt-modal-aspect-ratio, var(--sys-yt-modal-aspect-ratio)));position:absolute;top:50%;transform:translate(-50%) translateY(-50%);width:77.80879vw;z-index:2002}.yt-modal--influencer[data-orientation=portrait]{--yt-player-max-height: 75vh}.yt-modal--influencer .yt-modal__buttons{display:flex;justify-content:center;position:absolute;width:100%;left:50%;top:calc(50% + 48px);transform:translate(-50%) translateY(-50%);margin-top:min(var(--yt-player-height) / 2,var(--yt-player-max-height) / 2);z-index:2003}.yt-modal--influencer .yt-modal__buttons bds-button{--cmp-button-color-link: white;--cmp-button-color-hover-link: #8ab4f8}.yt-modal--influencer .yt-modal__buttons bds-button.active{--cmp-button-color-link: #8ab4f8;pointer-events:none}@media (max-width: 1023px){.yt-modal--influencer .yt-modal__buttons bds-button::part(button){padding-right:16px;padding-left:16px}}.yt-modal--influencer .yt-modal__buttons bds-button:first-child::part(button){border-color:#5f6368}
`;let r;const c={OPEN:"yt-modal-open",CLOSE:"yt-modal-close"};function p(){return r||(r=new E({namespace:"yt-modal",useHandlerOnMobile:!1,onModalOpen:t=>{document.dispatchEvent(new CustomEvent(c.OPEN))},onModalClose:t=>{t.getPlayer().stopVideo(),document.dispatchEvent(new CustomEvent(c.CLOSE))}}),x(),r)}function A(t,e){const i=p();if(!e){i.play(t);return}const a=u()&&e,o=a?e:t;i.play(o,{orientation:a?"portrait":void 0})}function x(){const t=document.createElement("style");return t.textContent=w,document.head.appendChild(t),t}async function S(){return new Promise(t=>{const e=p().getPlayer();if(typeof e?.getVideoUrl=="function"){const i=e.getVideoUrl();return t(i.split("=").pop())}e.addEventListener("onReady",()=>{const i=e.getVideoUrl();t(i.split("=").pop())})})}export{c as Y,S as a,p as g,A as p};
